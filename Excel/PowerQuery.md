[Top](../README.md) > [Excel](../Excel.md)

# PowerQuery
とりあえずまとめて書く<br>
きつくなってきたらM言語とビジュアル操作分ける

## M言語
- let<br>
ステップ（変数）宣言<br>
直前にコメント入れると「適用したステップ」該当箇所にカーソル合わせたときにコメント表示される
- in<br>
ステップ呼び出し

|コード|機能|備考|
|:--:|:--|:--|
|`Excel.CurrentWorkbook()`|開いてるExcelファイル上のテーブルを表示|「{[Name = "テーブル名"]}」で指定したテーブルの情報、そこからさらに「[Content]を加えることで指定したテーブルのデータ（コンテンツ）を表示できる」|
|`Table.TransformColumnTypes(テーブル, {{"フィールド名1", type データ型1},{"フィールド名2", type データ型2},...})`|指定したフィールドを指定したデータ型に変換|データ型はとりあえず「number」（整数）と「text」（文字列）を知っとけば基本は大丈夫そう|
|`Table.SelectRows(テーブル, each ([フィールド名1] = 値1 or [フィールド名2] = 値2 or ...) and ([フィールド名3] = 値3) and ...)`|指定したフィールドが指定した値であるデータを選択|andで別フィールドの条件（同時に満たす）、orで同一フィールドの条件（同時に満たさない）を追加できる|
|`Table.SelectColumns(テーブル, {"フィールド名1", "フィールド名2", ...})`|指定したフィールドのみ表示（選択）|-|